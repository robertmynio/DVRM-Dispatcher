package vdrm.base.impl;

import java.util.ArrayList;
import java.util.UUID;

import vdrm.base.data.IServer;
import vdrm.base.data.ITask;

public class Server implements IServer {
	
	// SERVER CHARACTERISTICS
	private int cpuFreq;
	private int memoryAmount;
	private int hddSize;
	
	private int usedCPU;
	private int usedRAM;
	private int usedHDD;
	
	private boolean isFull;
	private boolean isEmpty;
	
	private UUID serverID;
	
	
	// TASKS REPRESENTATION
	private ArrayList<ITask> taskList;
	private int nrOfTasks;
	private int nrOfPredictedTasks;
	
	
	
	@Override
	public ITask GetNextHighestDemandingTask() {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public ITask GetNextLowestDemandingTask() {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public ITask GetTaskWithResources(ArrayList<Integer> resourceDemands) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public void OrderStandBy() {
		// TODO Auto-generated method stub
		
	}

	@Override
	public void OrderWakeUp() {
		// TODO Auto-generated method stub
		
	}

	@Override
	public boolean addTask(ITask task) {
		try{
			taskList.add(task);
			if(task.isPredicted())
				nrOfPredictedTasks++;
			nrOfTasks++;
			usedCPU += task.getCpu();
			usedRAM += task.getMem();
			usedHDD += task.getHdd();
			
			if( (usedCPU == cpuFreq) || 
				(usedRAM == memoryAmount)||
				(usedHDD == hddSize))
				isFull = true;
			return true;
		}catch(Exception ex){
			return false;
		}
	}

	@Override
	public int getMaxCpu() {
		return cpuFreq;
	}

	@Override
	public int getMaxHdd() {
		return hddSize;
	}

	@Override
	public int getMaxMem() {
		return memoryAmount;
	}

	@Override
	public int getNumberOfPredictedTasks() {
		return nrOfPredictedTasks;
	}

	@Override
	public int getTotalNumberOfTasks() {
		return nrOfTasks;
	}

	@Override
	public int getUsedCpu() {
		return usedCPU;
	}

	@Override
	public int getUsedHdd() {
		return usedHDD;
	}

	@Override
	public int getUsedMem() {
		return usedRAM;
	}

	@Override
	public boolean isFull() {
		return isFull;
	}

	@Override
	public boolean removeTask(ITask task) {
		try{
			if(taskList.isEmpty() != true){
				if(taskList.contains(task)){
					taskList.remove(task);
					usedCPU -= task.getCpu();
					usedRAM -= task.getMem();
					usedHDD -= task.getHdd();
					if(task.isPredicted())
						nrOfPredictedTasks--;
					nrOfTasks--;
					if(nrOfTasks==0)
						isEmpty = true;
				}
			}
			return true;
		}catch(Exception ex){
			return false;
		}
	}

	@Override
	public boolean removeTask(UUID taskId) {
		try{
			if(taskList.isEmpty() != true){
				for(ITask t : taskList){
					if(t.getTaskHandle() == taskId){
						taskList.remove(t);
						usedCPU -= t.getCpu();
						usedRAM -= t.getMem();
						usedHDD -= t.getHdd();
						if(t.isPredicted())
							nrOfPredictedTasks--;
						nrOfTasks--;
						if(nrOfTasks==0)
							isEmpty = true;
					}
						
				}
			}
			return true;
		}catch(Exception ex){
			return false;
		}
	}

	@Override
	public UUID getServerID() {
		return serverID;
	}

}
